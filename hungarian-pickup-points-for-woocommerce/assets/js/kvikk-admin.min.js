jQuery(document).ready(function(i){var o={home_delivery_pricing:{},pickup_point_pricing:{},cod_pricing:{},$metabox:i(".vp-woo-pont-metabox-content"),$home_delivery_providers:i(".vp-woo-pont-metabox-rows-data-home-delivery-providers"),$metabox_weight_input:i("#vp_woo_pont_package_weight"),$metabox_calculated_price:i(".vp-woo-pont-metabox-rows-kvikk-price"),$modifyProviderButton:i("#vp_woo_pont_modify_provider"),$enabled_providers:i(".vp-woo-pont-providers"),$homeDeliveryProviderInput:i('input[name="home_delivery_provider"]'),currency_formatter:new Intl.NumberFormat("hu-HU",{style:"currency",currency:"HUF",minimumFractionDigits:0,maximumFractionDigits:0}),init:function(){vp_woo_pont_kvikk_params.couriers&&vp_woo_pont_kvikk_params.couriers.pricing&&vp_woo_pont_kvikk_params.couriers.pricing.shipping&&(this.shipping_pricing=vp_woo_pont_kvikk_params.couriers.pricing.shipping,this.cod_pricing=vp_woo_pont_kvikk_params.couriers.pricing.cod,this.display_metabox_shipping_cost(),this.$metabox_weight_input.on("keyup",this.display_metabox_shipping_cost),this.display_single_metabox_shipping_cost(),this.$modifyProviderButton.on("click",this.show_provider_options),this.$homeDeliveryProviderInput.on("change",this.on_provider_change),i(document.body).on("vp_woo_pont_metabox_pickup_point_changed",this.on_provider_change))},show_provider_options:function(){return o.$metabox_calculated_price.slideUp(),!1},on_provider_change:function(){setTimeout(function(){o.display_single_metabox_shipping_cost()},100)},check_if_provider_selected:function(){i(".vp-woo-pont-providers-wrapper").addClass("provider-selected"),0==i('.vp-woo-pont-providers input[name="vp_woo_pont_enabled_providers[]"]:checked').length&&i(".vp-woo-pont-providers-wrapper").removeClass("provider-selected")},display_metabox_shipping_cost:function(){o.$home_delivery_providers.find("li").each(function(){var e=i(this).data("provider");if(0===e.indexOf("kvikk")){e=e.replace("kvikk_","");var t=o.$metabox_weight_input.val(),n=o.$metabox.data("cod"),p=o.calculate_shipping_cost(e,t,n),r=o.currency_formatter.format(p),c=i(this).find(".shipping-cost").data("label");p?i(this).find(".shipping-cost").text(c+": "+r):i(this).find(".shipping-cost").text(c+": -")}})},calculate_shipping_cost:function(i,e,t){var n=0,p=0,r=0;const c=o.shipping_pricing.find(o=>o.courier===i),_=o.cod_pricing.find(o=>o.courier===i);if(!c||!_)return!1;const a=c.prices.find(i=>e>=i.min&&e<=i.max);if(!a)return!1;if(n=a.cost,t){t=parseInt(t);const i=_.prices.find(i=>t>=i.min&&t<=i.max);i&&(console.log(i),p=i.fee,r=t*i.percentage/100)}return n+p+r},display_single_metabox_shipping_cost:function(){if(i("#vp_woo_pont_metabox_kvikk").length)o.$metabox_calculated_price.slideUp();else{var e=i(".vp-woo-pont-metabox-rows-data-provider").find("i").attr("class");if(e.includes("kvikk")){e=e.replace("vp-woo-pont-provider-icon-kvikk_","");var t=o.$metabox_weight_input.val(),n=o.$metabox.data("cod"),p=o.calculate_shipping_cost(e,t,n);p?(o.$metabox_calculated_price.slideDown(),o.$metabox_calculated_price.find("strong").text(o.currency_formatter.format(p))):o.$metabox_calculated_price.slideUp()}else o.$metabox_calculated_price.slideUp()}}};i("#vp_woo_pont_metabox").length&&o.init();var e={init:function(){i(document).on("click",".kvikk-promo-close",this.hide_promo.bind(this)),i(document).on("click",".kvikk-promo-hide",this.hide_promo.bind(this)),i(document).on("click",".kvikk-promo-cta",this.cta_click.bind(this))},hide_promo:function(){i(".kvikk-promo").slideUp();var o=i(".kvikk-promo").data("nonce");return i.post(ajaxurl,{action:"vp_woo_pont_hide_kvikk_promo",nonce:o}),!1},cta_click:function(){e.hide_promo()}};(i(".kvikk-promo").length||i("#tmpl-vp-woo-pont-modal-generate").length)&&e.init()});